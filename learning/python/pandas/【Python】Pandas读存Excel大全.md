# ã€Pythonã€‘Pandasè¯»å­˜Excelå¤§å…¨

<a id="profileBt"></a><a id="js_name"></a>æœºå™¨å­¦ä¹ åˆå­¦è€… *2022-05-02 14:35* *Posted on <a id="js_ip_wording"></a>æµ™æ±Ÿ*

The following article is from å°¤è€Œå°å±‹ Author å°¤è€Œå°å±‹

<a id="copyright_info"></a>[![](../../../_resources/0_0c3c318140ed40a7ae2ad834d85ca6bb.jpg)<br>**å°¤è€Œå°å±‹** .<br>å°¤è€Œå°å±‹ï¼Œä¸€ä¸ªæ¸©é¦¨ä¸”æœ‰çˆ±çš„å°å±‹ğŸ¡ å°å±‹ä¸»äººï¼Œä¸€æ‰‹ä»£ç è°‹æ±‚ç”Ÿå­˜ï¼Œä¸€æ‰‹æŒå‹ºäº«å—ç”Ÿæ´»ï¼Œæ¬¢è¿ä½ çš„å…‰ä¸´~](#)

> å…¬ä¼—å·ï¼šå°¤è€Œå°å±‹
> ä½œè€…ï¼šPeter
> ç¼–è¾‘ï¼šPeter

æœ¬æ–‡è®°å½•çš„**æ˜¯å¦‚ä½•é€šè¿‡Pandasæ¥è¯»å–Excelæ–‡ä»¶ï¼Œä»¥åŠå¦‚ä½•å°†DataFrameä¿å­˜åˆ°Excelæ–‡ä»¶ä¸­**ã€‚

å®˜ç½‘å‚æ•°è¯¦è§£ï¼šhttps://pandas.pydata.org/docs/reference/api/pandas.read_excel.html

## å‚æ•°

read_excelå‡½æ•°èƒ½å¤Ÿè¯»å–çš„æ ¼å¼åŒ…å«ï¼šxls, xlsx, xlsm, xlsb, odf, ods å’Œ odt æ–‡ä»¶æ‰©å±•åã€‚æ”¯æŒè¯»å–å•ä¸€sheetæˆ–å‡ ä¸ªsheetã€‚

ä¸‹é¢è®°å½•çš„å®˜æ–¹æ–‡æ¡£ä¸­æä¾›çš„å…¨éƒ¨å‚æ•°ä¿¡æ¯ï¼š

```
pandas.read_excel(
Â Â io,Â Â Â Â 
Â Â sheet_name=0,Â 
Â Â header=0,Â 
Â Â names=None,Â 
Â Â index_col=None,Â 
Â Â usecols=None,Â 
Â Â squeeze=None,Â 
Â Â dtype=None,Â 
Â Â engine=None,Â 
Â Â converters=None,Â 
Â Â true_values=None,Â 
Â Â false_values=None,Â 
Â Â skiprows=None,Â 
Â Â nrows=None,Â 
Â Â na_values=None,
Â Â keep_default_na=True,Â 
Â Â na_filter=True,Â 
Â Â verbose=False,Â 
Â Â parse_dates=False,Â 
Â Â date_parser=None,Â 
Â Â thousands=None,Â 
Â Â decimal='.',Â 
Â Â comment=None,Â 
Â Â skipfooter=0,Â 
Â Â convert_float=None,Â 
Â Â mangle_dupe_cols=True,Â 
Â Â storage_options=None
)

```

ä¸‹é¢è§£é‡Šå¸¸ç”¨å‚æ•°çš„å«ä¹‰ï¼š

- ioï¼šæ–‡ä»¶è·¯å¾„ï¼Œæ”¯æŒ str, bytes, ExcelFile, xlrd.Book, path object, or file-like objectã€‚é»˜è®¤è¯»å–ç¬¬ä¸€ä¸ªsheetçš„å†…å®¹ã€‚æ¡ˆä¾‹ï¼š"/desktop/student.xlsx"
    
- sheet\_nameï¼šsheetè¡¨åï¼Œæ”¯æŒ str, int, list, or Noneï¼›é»˜è®¤æ˜¯0ï¼Œç´¢å¼•å·ä»0å¼€å§‹ï¼Œè¡¨ç¤ºç¬¬ä¸€ä¸ªsheetã€‚æ¡ˆä¾‹ï¼šsheet\_name=1, sheet\_name="sheet1"ï¼Œsheet\_name=\[1,2,"sheet3"\]ã€‚None è¡¨ç¤ºå¼•ç”¨æ‰€æœ‰sheet
    
- headerï¼šè¡¨ç¤ºç”¨ç¬¬å‡ è¡Œä½œä¸ºè¡¨å¤´ï¼Œæ”¯æŒ int, list of intï¼›é»˜è®¤æ˜¯0ï¼Œç¬¬ä¸€è¡Œçš„æ•°æ®å½“åšè¡¨å¤´ã€‚header=Noneè¡¨ç¤ºä¸ä½¿ç”¨æ•°æ®æºä¸­çš„è¡¨å¤´ï¼ŒPandasè‡ªåŠ¨ä½¿ç”¨0,1,2,3â€¦çš„è‡ªç„¶æ•°ä½œä¸ºç´¢å¼•ã€‚
    
- namesï¼šè¡¨ç¤ºè‡ªå®šä¹‰è¡¨å¤´çš„åç§°ï¼Œæ­¤æ—¶éœ€è¦ä¼ é€’æ•°ç»„å‚æ•°ã€‚
    
- index_colï¼šæŒ‡å®šåˆ—å±æ€§ä¸ºè¡Œç´¢å¼•åˆ—ï¼Œæ”¯æŒ int, list of int, é»˜è®¤æ˜¯Noneï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•ä¸º0,1,2,3ç­‰è‡ªç„¶æ•°çš„åˆ—ç”¨ä½œDataFrameçš„è¡Œæ ‡ç­¾ã€‚å¦‚æœä¼ å…¥çš„æ˜¯åˆ—è¡¨å½¢å¼ï¼Œåˆ™è¡Œç´¢å¼•ä¼šæ˜¯å¤šå±‚ç´¢å¼•
    
- usecolsï¼šå¾…è§£æçš„åˆ—ï¼Œæ”¯æŒ int, str, list-like, or callable ï¼Œé»˜è®¤æ˜¯ Noneï¼Œè¡¨ç¤ºè§£æå…¨éƒ¨çš„åˆ—ã€‚
    
- dtypeï¼šæŒ‡å®šåˆ—å±æ€§çš„å­—æ®µç±»å‹ã€‚æ¡ˆä¾‹ï¼š{â€˜aâ€™: np.float64, â€˜bâ€™: np.int32}ï¼›é»˜è®¤ä¸ºNoneï¼Œä¹Ÿå°±æ˜¯ä¸æ”¹å˜æ•°æ®ç±»å‹ã€‚
    
- engineï¼šè§£æå¼•æ“ï¼›å¯ä»¥æ¥å—çš„å‚æ•°æœ‰"xlrd"ã€"openpyxl"ã€"odf"ã€"pyxlsb"ï¼Œç”¨äºä½¿ç”¨ç¬¬ä¸‰æ–¹çš„åº“å»è§£æexcelæ–‡ä»¶
    

- â€œxlrdâ€æ”¯æŒæ—§å¼ Excel æ–‡ä»¶ (.xls)
    
- â€œopenpyxlâ€æ”¯æŒæ›´æ–°çš„ Excel æ–‡ä»¶æ ¼å¼
    
- â€œodfâ€æ”¯æŒ OpenDocument æ–‡ä»¶æ ¼å¼(.odfã€.odsã€.odt)
    
- â€œpyxlsbâ€æ”¯æŒäºŒè¿›åˆ¶ Excel æ–‡ä»¶
    

- convertersï¼šå¯¹æŒ‡å®šåˆ—è¿›è¡ŒæŒ‡å®šå‡½æ•°çš„å¤„ç†ï¼Œä¼ å…¥å‚æ•°ä¸ºåˆ—åä¸å‡½æ•°ç»„æˆçš„å­—å…¸ï¼Œå’Œusecolså‚æ•°è¿ç”¨ã€‚key å¯ä»¥æ˜¯åˆ—åæˆ–è€…åˆ—çš„åºå·ï¼Œvaluesæ˜¯å‡½æ•°ï¼Œå¯ä»¥è‡ªå®šä¹‰çš„å‡½æ•°æˆ–è€…Pythonçš„åŒ¿ålambdaå‡½æ•°
    
- skiprowsï¼šè·³è¿‡æŒ‡å®šçš„è¡Œï¼ˆå¯é€‰å‚æ•°ï¼‰ï¼Œç±»å‹ä¸ºï¼šlist-like, int, or callable
    
- nrowsï¼šæŒ‡å®šè¯»å–çš„è¡Œæ•°ï¼Œé€šå¸¸ç”¨äºè¾ƒå¤§çš„æ•°æ®æ–‡ä»¶ä¸­ã€‚ç±»å‹int, é»˜è®¤æ˜¯Noneï¼Œè¯»å–å…¨éƒ¨æ•°æ®
    
- na_valuesï¼šæŒ‡å®šåˆ—çš„æŸäº›ç‰¹å®šå€¼ä¸ºNaN
    
- keep\_default\_naï¼šæ˜¯å¦å¯¼å…¥ç©ºå€¼ï¼Œé»˜è®¤æ˜¯å¯¼å…¥ï¼Œè¯†åˆ«ä¸ºNaN
    

## æ¨¡æ‹Ÿæ•°æ®

ç°åœ¨æœ¬æ¬¡æ¨¡æ‹Ÿäº†ä¸¤ä¸ªæ•°æ®**ï¼šPandas\_Excel.xls å’Œ Pandas\_Excel.xlsx**

Pandas_Excel.xls æ–‡ä»¶ä¸­åŒ…å«ä¸¤ä¸ªsheetï¼Œ**ç¬¬äºŒä¸ªæ•°æ®åªæ¯”ç¬¬ä¸€ä¸ªå¤šä¸ªindexçš„ä¿¡æ¯**

1ã€sheet1çš„å†…å®¹

![Image](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

image-20220423115151077

2ã€sheet2çš„å†…å®¹

![Image](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

3ã€Pandas_Excel.xlsxçš„å†…å®¹ï¼Œæ¨¡æ‹Ÿçš„å®Œæ•´ä¿¡æ¯ï¼š

![Image](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

```
importÂ pandasÂ asÂ pd

```

## é»˜è®¤æƒ…å†µ

æ­¤æ—¶æ–‡ä»¶åˆšå¥½åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œè¯»å–çš„æ—¶å€™æŒ‡å®šæ–‡ä»¶åå³å¯ï¼Œå¯ä»¥çœ‹åˆ°è¯»å–çš„æ˜¯ç¬¬ä¸€ä¸ªsheet

```
dfÂ =Â pd.read_excel("Pandas-Excel.xls")
df

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 5   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

## å‚æ•°io

å¡«å†™å®Œæ•´çš„æ–‡ä»¶è·¯å¾„ä½œä¸ºioçš„å–å€¼ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„

```
pd.read_excel(r"/Users/peter/Desktop/pandas/Pandas-Excel.xls")

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 5   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

## å‚æ•°sheet_name

```
#Â pd.read_excel("Pandas-Excel.xls",Â sheet_name=0)Â #Â æ•ˆæœåŒä¸Š
#Â ç›´æ¥æŒ‡å®šsheetçš„åå­—
pd.read_excel("Pandas-Excel.xls",Â sheet_name="Sheet1")Â #Â æ•ˆæœåŒä¸Š

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 5   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

æ¢æˆè¯»å–ç¬¬äºŒä¸ªsheetï¼šåç§°æ˜¯Sheet2

```
pd.read_excel("Pandas-Excel.xls",Â sheet_name="Sheet2")Â 

```

|     | index | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- | --- |
| 0   | 1   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | 2   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | 3   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 3   | 4   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | 5   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 5   | 6   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

ç»“æœä¸­å¤šäº†ä¸€åˆ—indexçš„å–å€¼

## å‚æ•°header

```
#Â å’Œé»˜è®¤æƒ…å†µç›¸åŒ
pd.read_excel("Pandas-Excel.xls",Â header=[0])Â 

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 5   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

```
pd.read_excel("Pandas-Excel.xls",Â header=[1])Â Â #Â å•ä¸ªå…ƒç´ 

```

ç¬¬ä¸€è¡Œçš„æ•°æ®å½“åšåˆ—å±æ€§ï¼š

|     | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 00:00:00 |
| --- | --- | --- | --- | --- | --- |
| 0   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 1   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 2   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 3   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 4   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

ä¼ å…¥å¤šä¸ªå…ƒç´ ä¼šå½¢æˆå¤šå±‚ç´¢å¼•ï¼š

```
pd.read_excel("Pandas-Excel.xls",Â header=[0,1])Â Â Â #Â å¤šä¸ªå…ƒç´ 

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
|     | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 00:00:00 |
| --- | --- | --- | --- | --- | --- |
| 0   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 1   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 2   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 3   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 4   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

## å‚æ•°names

```
#Â æŒ‡å®šåˆ—åç§°
pd.read_excel("Pandas-Excel.xls",Â names=["a","b","c","d","e"])Â Â Â 

```

|     | a   | b   | c   | d   | e   |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 5   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

## å‚æ•°index_col

```
#Â æŒ‡å®šå•ä¸ªå…ƒç´ ä½œä¸ºç´¢å¼•
pd.read_excel("Pandas-Excel.xls",Â index_col=[0])Â 

```

|     | age | sex | address | date |
| --- | --- | --- | --- | --- |
| name |     |     |     |     |
| --- | --- | --- | --- | --- |
| å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

```
#Â å¤šä¸ªå…ƒç´ 
pd.read_excel("Pandas-Excel.xls",Â index_col=[0,1])Â Â Â 

```

|     |     | sex | address | date |
| --- | --- | --- | --- | --- |
| name | age |     |     |     |
| --- | --- | --- | --- | --- |
| å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

## å‚æ•°usecols

```
pd.read_excel("Pandas-Excel.xls",Â usecols=[0])Â Â Â #Â å•ä¸ªå­—æ®µ

```

|     | name |
| --- | --- |
| 0   | å¼ ä¸‰  |
| 1   | æå››  |
| 2   | å°æ˜  |
| 3   | å¼ é£  |
| 4   | å°è‹  |
| 5   | å°ç‹  |

```
pd.read_excel("Pandas-Excel.xls",Â usecols=[0,2,4])Â Â Â #Â å¤šä¸ªå­—æ®µ

```

|     | name | sex | date |
| --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | ç”·   | 2022-04-01 |
| 1   | æå››  | ç”·   | 2022-04-02 |
| 2   | å°æ˜  | æœªçŸ¥  | 2022-04-05 |
| 3   | å¼ é£  | å¥³   | 2021-09-08 |
| 4   | å°è‹  | å¥³   | 2022-06-07 |
| 5   | å°ç‹  | ç”·   | 2022-05-09 |

```
#Â ç›´æ¥æŒ‡å®šåç§°
Â Â Â Â 
pd.read_excel("Pandas-Excel.xls",Â usecols=["age","sex"])Â Â 

```

|     | age | sex |
| --- | --- | --- |
| 0   | 23  | ç”·   |
| 1   | 16  | ç”·   |
| 2   | 26  | æœªçŸ¥  |
| 3   | 28  | å¥³   |
| 4   | 20  | å¥³   |
| 5   | 0   | ç”·   |

```
#Â ä¼ å…¥åŒ¿åå‡½æ•°ï¼Œå­—æ®µä¸­åŒ…å«aï¼Œç»“æœsexæ²¡æœ‰äº†
pd.read_excel("Pandas-Excel.xls",Â usecols=lambdaÂ x:Â "a"Â inÂ x)

```

|     | name | age | address | date |
| --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | NaN | 2022-06-07 |
| 5   | å°ç‹  | 0   | å—äº¬  | 2022-05-09 |

## å‚æ•°dtype

```
df.dtypesÂ Â 

```

```
name               object
age                 int64
sex                object
address            object
date       datetime64[ns]
dtype: object

```

ä»ä¸Šé¢çš„ç»“æœä¸­çœ‹åˆ°ageå­—æ®µï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹è¯»å–çš„æ˜¯int64ç±»å‹ï¼š

```
#Â æŒ‡å®šæ•°æ®ç±»å‹
df1Â =Â pd.read_excel("Pandas-Excel.xls",Â dtype={"age":"float64"})
#Â æŸ¥çœ‹å­—æ®µä¿¡æ¯
df1.dtypes

```

```
nameÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â object
ageÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â float64Â Â #Â ä¿®æ”¹
sexÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â object
addressÂ Â Â Â Â Â Â Â Â Â Â Â object
dateÂ Â Â Â Â Â Â datetime64[ns]
dtype:Â object

```

## å‚æ•°engine

```
#Â xlsÂ ç»“å°¾
pd.read_excel("Pandas-Excel.xls",Â engine="xlrd")

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 5   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

```
#Â xlsxÂ ç»“å°¾
pd.read_excel("Pandas-Excel.xlsx",Â engine="openpyxl")

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | ç”·   | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | æ­å·  | 2022-06-07 |
| 5   | å°ç‹  | 25  | ç”·   | å—äº¬  | 2022-05-09 |

## å‚æ•°converters

```
pd.read_excel("Pandas-Excel.xlsx")Â Â #Â é»˜è®¤æ“ä½œ

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | ç”·   | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | æ­å·  | 2022-06-07 |
| 5   | å°ç‹  | 25  | ç”·   | å—äº¬  | 2022-05-09 |

```
pd.read_excel("Pandas-Excel.xlsx",Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â usecols=[1,3],Â Â #Â 1-ageÂ Â 3-addressÂ æ•°å€¼ä¸ºåŸç´¢å¼•å·
Â Â Â Â Â Â Â Â Â Â Â Â Â Â converters={0:lambdaÂ x:Â x+5,Â Â #Â 0ä»£è¡¨ä¸Šé¢[1,3]ä¸­çš„ç´¢å¼•å·
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 1:lambdaÂ x:Â xÂ +Â "å¸‚"
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â })

```

|     | age | address |
| --- | --- | --- |
| 0   | 28  | æ·±åœ³å¸‚ |
| 1   | 21  | å¹¿å·å¸‚ |
| 2   | 31  | æ·±åœ³å¸‚ |
| 3   | 33  | è‹å·å¸‚ |
| 4   | 25  | æ­å·å¸‚ |
| 5   | 30  | å—äº¬å¸‚ |

## å‚æ•°skiprows

```
pd.read_excel("Pandas-Excel.xls")Â Â Â #Â é»˜è®¤æƒ…å†µ

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 5   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

æŠŠå¼ ä¸‰å’Œæå››æ‰€åœ¨çš„è¡Œç›´æ¥è·³è¿‡ï¼š

```
pd.read_excel("Pandas-Excel.xls",Â skiprows=2)

```

|     | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 00:00:00 |
| --- | --- | --- | --- | --- | --- |
| 0   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 1   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 2   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 3   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

```
#Â è·³è¿‡å¶æ•°è¡Œ
pd.read_excel("Pandas-Excel.xls",Â skiprows=lambdaÂ x:Â x%2Â ==Â 0)

```

|     | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 00:00:00 |
| --- | --- | --- | --- | --- | --- |
| 0   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 1   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |

## å‚æ•°nrows

```
#Â æŒ‡å®šè¯»å–çš„è¡Œæ•°
pd.read_excel("Pandas-Excel.xls",Â nrows=2)

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |

## å‚æ•°na_values

```
pd.read_excel("Pandas-Excel.xls")Â Â #Â é»˜è®¤

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 5   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

```
pd.read_excel("Pandas-Excel.xls",Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â na_values={"sex":"æœªçŸ¥"})

```

sexå­—æ®µä¸­çš„æœªçŸ¥æ˜¾ç¤ºæˆäº†NaNï¼š

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | NaN | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 5   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

## å‚æ•°keep\_default\_na

```
pd.read_excel("Pandas-Excel.xls")Â Â #Â é»˜è®¤keep_default_na=True

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   | NaN | 2022-06-07 |
| 5   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

```
pd.read_excel("Pandas-Excel.xls",Â keep_default_na=False)

```

|     | name | age | sex | address | date |
| --- | --- | --- | --- | --- | --- |
| 0   | å¼ ä¸‰  | 23  | ç”·   | æ·±åœ³  | 2022-04-01 |
| 1   | æå››  | 16  | ç”·   | å¹¿å·  | 2022-04-02 |
| 2   | å°æ˜  | 26  | æœªçŸ¥  | æ·±åœ³  | 2022-04-05 |
| 3   | å¼ é£  | 28  | å¥³   | è‹å·  | 2021-09-08 |
| 4   | å°è‹  | 20  | å¥³   |     | 2022-06-07 |
| 5   | å°ç‹  | 0   | ç”·   | å—äº¬  | 2022-05-09 |

## è¾“å‡ºåˆ°excelæ–‡ä»¶

ç®€å•æ¨¡æ‹Ÿä¸€ä»½æ•°æ®ï¼š

```
df2Â =Â pd.DataFrame({"num1":[1,2,3],
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â "num2":[4,5,6],
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â "num3":[7,8,9]})
df2

```

|     | num1 | num2 | num3 |
| --- | --- | --- | --- |
| 0   | 1   | 4   | 7   |
| 1   | 2   | 5   | 8   |
| 2   | 3   | 6   | 9   |

```
df2.to_excel("newdata_1.xlsx")

```

æ•ˆæœå¦‚ä¸‹ï¼š

![Image](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

```
df2.to_excel("newdata_2.xlsx",index=False)

```

ä¸ä¼šå¸¦ä¸Šç´¢å¼•å·

![Image](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

```


![Image](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

```


```


```


```


```


å¾€æœŸç²¾å½©å›é¡¾

- [é€‚åˆåˆå­¦è€…å…¥é—¨äººå·¥æ™ºèƒ½çš„è·¯çº¿åŠèµ„æ–™ä¸‹è½½](http://mp.weixin.qq.com/s?__biz=MzIwODI2NDkxNQ==&mid=2247484737&idx=1&sn=27c52b4bc4ca98d3ab817344b84226cc&chksm=97048efda07307eb78d4f4ec0039a386a658404156b051af0cb715fafa8d2ae66cbe49343bf3&scene=21#wechat_redirect)
    
- [(å›¾æ–‡+è§†é¢‘)æœºå™¨å­¦ä¹ å…¥é—¨ç³»åˆ—ä¸‹è½½](https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzIwODI2NDkxNQ==&action=getalbum&album_id=2259163844755406853#wechat_redirect)
    
- [ä¸­å›½å¤§å­¦æ…•è¯¾ã€Šæœºå™¨å­¦ä¹ ã€‹ï¼ˆé»„æµ·å¹¿ä¸»è®²ï¼‰](http://mp.weixin.qq.com/s?__biz=MzIwODI2NDkxNQ==&mid=2247502323&idx=1&sn=598d7231681ce2f316503201dd615c86&chksm=9707424fa070cb59f861a47f9eb4218cc5d3b835be49e93e67bb086dcc4c3b555a3546ebe9c5&scene=21#wechat_redirect)
    
- [æœºå™¨å­¦ä¹ åŠæ·±åº¦å­¦ä¹ ç¬”è®°ç­‰èµ„æ–™æ‰“å°](http://mp.weixin.qq.com/s?__biz=MzIwODI2NDkxNQ==&mid=2247488304&idx=1&sn=581944f63eab1822ca53b9a4eeedad79&chksm=9704988ca073119a38a534adbedd51ca0b5705cdd6a104fed74b265bb092485e97c91bb5b347&scene=21#wechat_redirect)
    
- [ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹çš„ä»£ç å¤ç°ä¸“è¾‘](https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&album_id=1337257945842778113&__biz=MzIwODI2NDkxNQ==#wechat_redirect)
    
- [AIåŸºç¡€ä¸‹è½½](http://mp.weixin.qq.com/s?__biz=MzIwODI2NDkxNQ==&mid=2247487602&idx=2&sn=478d9893e85d564282334654b3be7fda&chksm=97049bcea07312d8b74ac7e99e3a3dbea331315c1439888f4e16e912b18d3d8626f36e1fc0df&scene=21#wechat_redirect)
    
- æœºå™¨å­¦ä¹ äº¤æµqqç¾¤955171419ï¼ŒåŠ å…¥å¾®ä¿¡ç¾¤è¯·æ‰«ç ï¼š
    




```

![Image](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)


```


```


```


```






```

People who liked this content also liked

ã€Dockerã€‘å‘½ä»¤ä½¿ç”¨å¤§å…¨

...

å°ç™½å­¦è§†è§‰

ä¸çœ‹çš„åŸå› 

- å†…å®¹è´¨é‡ä½
- ä¸çœ‹æ­¤å…¬ä¼—å·

ç”¨Pythonå»é™¤å›¾ç‰‡èƒŒæ™¯ï¼šâ€‹Rembgåº“

...

Pythonå¤§æ•°æ®åˆ†æ

ä¸çœ‹çš„åŸå› 

- å†…å®¹è´¨é‡ä½
- ä¸çœ‹æ­¤å…¬ä¼—å·

Rè¯­è¨€çš„24ä¸ªé«˜æ•ˆæ“ä½œ

...

åŸºå› å­¦è‹‘

ä¸çœ‹çš„åŸå› 

- å†…å®¹è´¨é‡ä½
- ä¸çœ‹æ­¤å…¬ä¼—å·

<img width="102" height="102" src="../../../_resources/qrcode_scene_10000004_size_102___39e8bb7aa08e4569a.bmp"/>

Scan to Follow